# Test coverage provided by this container:
# - arm64
# - hostonly
# - network-legacy
# - hmaccalc (fido)
# - rdma out of tree dracut module
# - dbus-broker
# - network: network-legacy, network-manager
# - zstd compression
# - erofs is blacklisted by default and not supported in openSUSE

FROM registry.opensuse.org/opensuse/tumbleweed:latest

# Install needed packages for the dracut CI container
RUN zypper --non-interactive install --no-recommends \
    bash-completion \
    btrfsprogs \
    cargo \
    cpio \
    cryptsetup \
    dhcp-client \
    dhcp-server \
    diffutils \
    dnsmasq \
    distribution-gpg-keys \
    e2fsprogs \
    gcc \
    git \
    gpg2 \
    hmaccalc \
    iproute2 \
    iputils \
    iscsiuio \
    kbd \
    kernel-vanilla \
    libfido2 \
    libkmod-devel \
    lvm2 \
    make \
    mdadm \
    nbd \
    NetworkManager \
    nfs-kernel-server \
    open-iscsi \
    parted \
    pciutils \
    python3 \
    python3-pefile \
    qemu \
    ruby4.0-rubygem-asciidoctor \
    squashfs \
    swtpm \
    systemd-boot \
    systemd-container \
    systemd-devel \
    systemd-experimental \
    systemd-portable \
    tgt \
    tpm2.0-tools \
    util-linux-systemd \
    xfsprogs \
    xorriso \
    zstd \
    && zypper --non-interactive dist-upgrade --no-recommends
