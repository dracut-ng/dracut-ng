# Test coverage provided by this container:
# - default hostonly
# - musl (instead of glibc)
# - openrc (instead of systemd)
# - eudev (instead of systemd-udev)
# - elogind (instead of logind)
# - busybox default shell (no dash installed)
# - gzip compression
# - dbus-daemon
# - network: networkmanager

# Not installed
# - cargo (to increase coverage)
# - dash (to increase coverage)
# - ntfs-3g (not enabled with linux-virt)
# - erofs-utils (not enabled with linux-virt)
# - multipath-tools (does not work well)
# - ovmf (systemd-boot-efistub, UEFI, UKI is not available)
# - kernel-install is not available

ARG DISTRIBUTION=alpine
FROM docker.io/${DISTRIBUTION}

# export ARG
ARG DISTRIBUTION

# Packages to pass the BASIC test
# Use dracut-tests package to install dependencies for test suite
RUN apk add --no-cache \
    asciidoctor \
    dracut-tests \
    file \
    gcc \
    kmod \
    kmod-dev \
    linux-virt \
    make \
    musl-dev \
    musl-fts-dev

# Packages for recent changes that are not yet released or packaged by dracut-tests
RUN apk add --no-cache \
    dnsmasq \
    networkmanager-cli \
    networkmanager-initrd-generator
